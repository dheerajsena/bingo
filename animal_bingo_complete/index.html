import shutil

# Creating a complete downloadable ZIP file containing:
# - HTML files (with relative image paths)
# - Image folder with images included

zip_dir = Path("/mnt/data/animal_bingo_complete")
images_zip_dir = zip_dir / "images"
cards_zip_dir = zip_dir / "cards"

# Ensure directory structure
images_zip_dir.mkdir(parents=True, exist_ok=True)
cards_zip_dir.mkdir(parents=True, exist_ok=True)

# Copy image files to the ZIP structure
for img_file in image_dir.glob("*.jpg"):
    shutil.copy(img_file, images_zip_dir)

# Generate new HTML files pointing to relative image paths for GitHub hosting
final_card_paths = []
for card_id in range(1, 11):
    selected_animals = random.sample(animals_extended, 24)
    card = []
    for i in range(5):
        row = []
        for j in range(5):
            if i == 2 and j == 2:
                row.append("free")
            else:
                row.append(selected_animals.pop())
        card.append(row)

    # Generate HTML with relative paths
    def generate_relative_html_card(card_id, card_animals):
        table_html = "<table class='bingo'>\n<tr><th>B</th><th>I</th><th>N</th><th>G</th><th>O</th></tr>\n"
        for i in range(5):
            table_html += "<tr>"
            for j in range(5):
                if i == 2 and j == 2:
                    cell_content = "<div class='cell'><div class='image'><img src='../images/free.jpg' alt='FREE'></div><div class='label'>FREE</div></div>"
                else:
                    animal = card_animals[i][j]
                    img_path = f"../images/{animal.lower()}.jpg"
                    cell_content = f"<div class='cell'><div class='image'><img src='{img_path}' alt='{animal}'></div><div class='label'>{animal.title()}</div></div>"
                table_html += f"<td>{cell_content}</td>"
            table_html += "</tr>\n"
        table_html += "</table>\n"

        html_template = f"""
        <html>
        <head>
            <style>
                body {{
                    font-family: 'Comic Sans MS', cursive, sans-serif;
                    text-align: center;
                    padding: 40px;
                    background-color: #fff8dc;
                }}
                h1 {{
                    font-size: 60px;
                    color: #4caf50;
                    letter-spacing: 8px;
                }}
                table.bingo {{
                    width: 90%;
                    margin: auto;
                    border-collapse: collapse;
                    table-layout: fixed;
                }}
                table.bingo th {{
                    background-color: #ffcc00;
                    color: black;
                    padding: 10px;
                    border: 2px solid #000;
                    font-size: 24px;
                }}
                table.bingo td {{
                    border: 2px solid #000;
                    padding: 10px;
                    vertical-align: top;
                    height: 160px;
                }}
                .cell .image img {{
                    width: 80px;
                    height: 80px;
                    object-fit: contain;
                    margin-bottom: 10px;
                }}
                .cell .label {{
                    font-size: 18px;
                    font-weight: bold;
                }}
            </style>
        </head>
        <body>
            <h1>ANIMAL BINGO</h1>
            {table_html}
            <p style="margin-top: 40px;">Card #{card_id}</p>
        </body>
        </html>
        """
        return html_template

    html_content = generate_relative_html_card(card_id, card)
    file_path = cards_zip_dir / f"bingo_card_{card_id}.html"
    with open(file_path, "w") as f:
        f.write(html_content)
    final_card_paths.append(file_path)

# Zip the entire folder structure
final_zip_path = "/mnt/data/animal_bingo_complete.zip"
shutil.make_archive("/mnt/data/animal_bingo_complete", 'zip', zip_dir)

final_zip_path
